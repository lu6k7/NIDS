这是一个Linux服务器NIDS检测脚本，此脚本利用了利用NetfilterQueue+IPTables模块对流量进行检测及分析，并实现阈值预警

​	它能够帮助您检测常见的网络攻击和安全问题，包括：

1. ICMP攻击检测：通过检测接收到的ICMP类型的次数来判断是否存在ICMP攻击。

2. DoS攻击检测：通过检测目标IP地址的访问流量的次数来判断是否存在DoS攻击。

3. URL地址扫描检测：通过检测404页面的次数来判断是否存在URL地址扫描攻击。

4. Web常见攻击检测：包括CSRF攻击、XSS注入、SQL注入、文件木马检测、文件包含漏洞、SSRF攻击、反序列化攻击、命令注入等，同时支持自定义其他web攻击检测。

5. 端口扫描检测：通过检测接收到的TCP SYN包来判断是否存在端口扫描攻击。

6. 登录暴破检测：支持redis、mysql、ssh等常见服务端口的登录暴破检测，同时支持自定义其他服务端口的登录暴破检测。

   



使用方式:

1.本脚本利用mysql统计流量信息，需要手动为数据库导入accesslog.sql文件，数据库信息和密码需要在`mysql.py`文件中修改

2.直接执行 `home.py` pyhon 文件进行NIDS流量监控脚本使用

3.可自定义规则库，规则文件及规则如下:

```
brute.json：默认检测redis和mysql登录暴破,可添加及自定义规则库


参数:

danger：符合特征的流量包是否接收 0：接收 1: 丢弃
content:用户使用此服务正常登录时的特征，即服务器发送数据包回到客户端携带的数据内容
port:服务的端口
tracktype:使用者自定义其服务名称，可为任意内容，使用者记住即可
threshold:阈值，登录行为达到此值识别为登录暴破
```

```
payload.json:web攻击检测,可添加及自定义规则库


参数:

payload: 对带有数据的流量包进行匹配的内容，要求为正则表达式
threshold:阈值，web检测多少次进行主动响应
```



示例:

![1682396322698](.\1682396322698.jpg)





该脚本使用Python编写，通过调用一些常见的Python库来完成网络数据包的抓取、解析和分析等功能。同时，它还提供了简单易用的命令行接口，使用户可以方便地进行选择和使用。

请注意，该脚本仅作为一种简单的网络安全工具，无法保证100%的安全性。在使用该脚本时，请务必结合其他安全措施，以确保网络安全。